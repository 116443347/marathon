<!DOCTYPE html>
<html lang="en">
  <head>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Marathon: Code Culture</title>
    <link rel="icon" type="image/x-icon" href="/marathon/img/marathon-favicon.ico">
    <link href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="/marathon/css/style.css" rel="stylesheet">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-45222428-4', 'auto');
      ga('send', 'pageview');

    </script>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="container-fluid">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/marathon">Marathon</a>
              </div>
              <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav">
                  <li class="active">
                    <a href="/marathon/docs/">Docs</a>
                  </li>
                  <li >
                    <a href="/marathon/support.html">Support</a>
                  </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="https://github.com/mesosphere/marathon">GitHub</a></li>
                </ul>
                <div class="grid" id="searchBar">
                  <div id="search">
                    <form role="search" method="get" action="/marathon/search/">
                      <input id="searchString" name="searchString"
                             placeholder="Search Marathon Docs" type="text">
                      <input id="searchButton" name="googleSearchName" type="submit" value="Search">
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
    <div class="col-sm-3">

        <h5>Getting Started</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/">
                    Install Marathon
                </a>
            </li>
            <li>
                <a href="/marathon/docs/setup.html">
                    Setup Recommendations
                </a>
            </li>
            <li>
                <a href="/marathon/docs/high-availability.html">
                    High Availability Mode
                </a>
            </li>
        </ul>

        <h5>Using Marathon</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/application-basics.html">
                    Application Basics
                </a>
            </li>
            <li>
                <a href="/marathon/docs/deployments.html">
                    Application Deployments
                </a>
            </li>
            <li>
                <a href="/marathon/docs/application-groups.html">
                    Application Groups
                </a>
            </li>
            <li>
                <a href="/marathon/docs/auth-access-ctrl.html">
                    Authorization and Access Control
                </a>
            </li>
            <li>
                <a href="/marathon/docs/blue-green-deploy.html">
                    Blue-Green Deployment
                </a>
            </li>
            <li>
                <a href="/marathon/docs/constraints.html">
                    Constraints
                </a>
            </li>
            <li>
                <a href="/marathon/docs/event-bus.html">
                    Event Bus
                </a>
            </li>
            <li>
                <a href="/marathon/docs/health-checks.html">
                    Health Checks
                </a>
            </li>
            <li>
                <a href="/marathon/docs/marathon-ui.html">
                    Marathon Web Interface
                </a>
            </li>
            <li>
                <a href="/marathon/docs/networking.html">
                    Networking
                </a>
            </li>
            <li>
                <a href="/marathon/docs/pods.html">
                    Pods
                </a>
            </li>
            <li>
                <a href="/marathon/docs/recipes.html">
                    Recipes
                </a>
            </li>
            <li>
                <a href="/marathon/docs/native-docker.html">
                    Provisioning Containers
                </a>
            </li>
            <li>
                <a href="/marathon/docs/persistent-volumes.html">
                    Stateful Applications Using Local Persistent Volumes
                </a>
            </li>
            <li>
                <a href="/marathon/docs/external-volumes.html">
                    Stateful Applications Using External Persistent Volumes
                </a>
            </li>
            <li>
                <a href="/marathon/docs/task-environment-vars.html">
                    Task Environment Variables
                </a>
            </li>
            <li>
                <a href="/marathon/docs/task-handling.html">
                    Task Handling
                </a>
            </li>
            <li>
                <a href="/marathon/docs/configure-task-handling.html">
                    Task Handling Configuration
                </a>
            </li>
            <li>
                <a href="/marathon/docs/secrets.html">
                    Secret Configuration
                </a>
            </li>
            <li>
                <a href="/marathon/docs/unreachable.html">
                    Unreachable Strategy
                </a>
            </li>
        </ul>

        <h5>Administration</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/command-line-flags.html">
                    Command Line Flags
                </a>
            </li>
            <li>
                <a href="/marathon/docs/backup-restore.html">
                    Backup and Restore
                </a>
            </li>
            <li>
                <a href="/marathon/docs/data-migration.html">
                    Data Migration
                </a>
            </li>
            <li>
                <a href="/marathon/docs/framework-authentication.html">
                    Framework Authentication
                </a>
            </li>
            <li>
                <a href="/marathon/docs/high-availability.html">
                    High Availability
                </a>
            </li>
            <li>
                <a href="/marathon/docs/metrics.html">
                    Metrics
                </a>
            </li>
            <li>
                <a href="/marathon/docs/deprecated-metrics.html">
                    Deprecated Metrics
                </a>
            </li>
            <li>
                <a href="/marathon/docs/readiness-checks.html">
                    Readiness Checks
                </a>
            </li>
            <li>
                <a href="/marathon/docs/service-discovery-load-balancing.html">
                    Service Discovery and Load Balancing
                </a>
            </li>
            <li>
                <a href="/marathon/docs/ssl-basic-access-authentication.html">
                    SSL and Basic Authentication
                </a>
            </li>
            <li>
                <a href="/marathon/docs/native-docker-private-registry.html">
                    Using a Private Docker Registry
                </a>
            </li>
            <li>
                <a href="/marathon/docs/maintenance-mode.html">
                    Maintenance mode
                </a>
            </li>
            <li>
                <a href="/marathon/docs/mesos-compatibility.html">
                    Compatibility with Mesos
                </a>
            </li>
        </ul>

        <h5>Upgrading</h5>
        <ul class="list-unstyled">
          <li>
              <a href="/marathon/docs/upgrade/index.html">
                  Upgrading to a new Version
              </a>
          </li>
          <li>
              <a href="/marathon/docs/upgrade/network-api-for-apps.html">
                  Migrating Apps to the 1.5 Networking API
              </a>
          </li>
          <li>
              <a href="/marathon/docs/upgrade/network-api-migration.html">
                  Migrating Tools to the 1.5 Networking API
              </a>
          </li>
          <li>
              <a href="/marathon/docs/upgrade/versioning.html">
                  Versioning
              </a>
          </li>
        </ul>

        <h5>Troubleshooting</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/waiting.html">
                   Stuck App or Pod Deployments
                </a>
            </li>
            <li>
                <a href="/marathon/docs/host-port.html">
                    An App Requires a Specific Host Port
                </a>
            </li>
            <li>
                <a href="/marathon/docs/local-cert.html">
                    Error Using HTTPS with local CA Certificate
                </a>
            </li>
            <li>
                <a href="/marathon/docs/auth-secret.html">
                    Error Reading Authentication Secret
                </a>
            </li>
            <li>
                <a href="/marathon/docs/cfs.html">
                    Slow Docker apps and deployments
                </a>
            </li>
            <li>
                <a href="/marathon/docs/exit-codes.html">
                   Exit Codes
                </a>
            </li>
        </ul>

        <h5>Development</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/contributing.html">
                    Contributor Guidelines
                </a>
            </li>
            <li>
                <a href="/marathon/docs/core-architecture.html">
                    Current Marathon Development
                </a>
            </li>
            <li>
                <a href="/marathon/docs/plugin.html">
                    Extend Marathon with Plugins
                </a>
            </li>
            <li>
                <a href="/marathon/docs/developing-vm.html">
                    Run a Local Version of Marathon
                </a>
            </li>
        </ul>

        <h5>API Reference</h5>
        <ul class="list-unstyled">
        <li>
            <a href="/marathon/api-console/index.html">REST API Reference</a>
        </li>
        </ul>
        <h5>Docs for Previous Versions</h5>
        <ul class="list-unstyled">
            
            <li><a href="/marathon/1.7/docs">Version 1.7.x</a></li>
            
            <li><a href="/marathon/1.6/docs">Version 1.6.x</a></li>
            
            <li><a href="/marathon/1.5/docs">Version 1.5.x</a></li>
            
        </ul>
    </div>

    <div class="col-sm-9">
        <h1 id="code-culture">Code Culture</h1>

<h2 id="overview">Overview</h2>

<p>The code culture is a set of defaults ascribed to by the Marathon developer team. Since writing software is an optimization problem, we guide our design decisions with defaults, not rules. Deviations from our defaults require justification.</p>

<p>Our defaults are:</p>

<ul>
  <li>Code is legible on GitHub</li>
  <li>Immutability over mutability</li>
  <li>No smelly code</li>
  <li>Fail loud and proud</li>
  <li>Let it crash</li>
  <li>Don’t panic</li>
</ul>

<h2 id="code-is-legible-on-github">Code is Legible on GitHub</h2>

<p>This default speaks to the desire to write code that can be understood without needing an IDE. Marathon is written in Scala, so our defaults are specific as such.</p>

<h3 id="on-implicits">On Implicits</h3>

<p>Implicits are an important feature in Scala and are critical for the implementation of type-classes and DSLs.</p>

<p>Prefer:</p>

<ul>
  <li>Explicit conversion over implicit</li>
  <li>Explicit passing over implicit</li>
</ul>

<p>For our case, if implicits don’t help improve the design of code, we don’t use them. We avoid implicit conversions. We also avoid multi-priority implicits. When type classes help improve the design of code, we use implicits for type classes (IE serialization logic).</p>

<p>We prefer implicits to be used for contextual values such as execution contexts or the actor system. However, we prefer to be conservative, and pass the value explicitly for things like validators, authenticators, and normalizers.</p>

<h3 id="on-type-inference">On Type Inference</h3>

<p>If you are writing some function chain that has multiple levels of inferred function parameter types, we prefer to specify the parameter types.</p>

<p>Prefer:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groups.map { group: Group =&gt;
  group.apps
    .groupBy(_.container.image)
    .map { case (image: String, apps: Seq[App]) =&gt;
      image -&gt; apps.length
    }
  }
</code></pre></div></div>

<p>Over:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groups.map { group =&gt;
  group.apps.groupBy(_.container.image).map { case(k, v) =&gt;
    k -&gt; v.length
  }
}
</code></pre></div></div>

<h3 id="on-playing-code-golf">On Playing Code Golf</h3>

<p>Code golf is a game in which you implement some program in as few characters as possible.</p>

<p>We prefer not to play this game when working on Marathon. Instead, we focus on removing noise (boilerplate), while preserving valuable signal pertaining to the problem at hand.</p>

<h3 id="on-imports">On Imports</h3>

<p>We prefer, almost always, that imports go at the top of the file. Additionally, prefer explicit imports over wildcard imports.</p>

<p>Prefer:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import org.company.{Stringifier, Demuxer}
</code></pre></div></div>

<p>Over:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import org.company._
</code></pre></div></div>

<h2 id="immutability-over-mutability">Immutability Over Mutability</h2>

<p>Functional programming is what follows when you don’t mutate state. We prefer it, except in performance critical parts of our code.</p>

<p>We have a strong preference to encapsulate mutable state. References to data crossing the boundary of some module should be immutable.</p>

<h2 id="no-smelly-code">No Smelly Code</h2>

<p>We pay attention to <a href="https://en.wikipedia.org/wiki/Code_smell">code smells</a> and strive to write well encapsulated code.</p>

<ul>
  <li>A method should not receive more data than it needs to do its job.</li>
  <li>Changing some behavior should not result in “shotgun surgery”</li>
</ul>

<h2 id="fail-loud-and-proud">Fail Loud and Proud</h2>

<p>It is better to do nothing, than to do the wrong thing.</p>

<p>One of my favorite non-examples of this is found in PHP 5:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ echo '&lt;? print(strftime("%Y-%m-%d",strtotime("lol"))) ?&gt;' | php
1970-01-01
</code></pre></div></div>

<p>Another non-example is found in Marathon’s history. At one point in time, the storage layer would swallow the exception and return <code class="highlighter-rouge">None</code> if it could not deserialize some entity successfully, and this led to data loss.</p>

<p>We are strict in what we accept, and in what we emit. If input is not what we expect, don’t be fancy.</p>

<p>Fail loudly. Fail proudly.</p>

<h2 id="let-it-crash">Let it Crash</h2>

<p>We prefer to focus on state recovery, and not graceful tear down. We’d prefer to just crash and restart, rather than implement many complex error recovery handlers.</p>

<h2 id="dont-panic">Don’t Panic</h2>

<p>We prefer to that Exceptions are thrown only when something goes unexpectedly wrong outside of domain of the library.</p>

<p>For example:</p>

<ul>
  <li>A validation function should return validation errors, not throw them.</li>
  <li>A storage module will throw an exception if a connection is unavailable.</li>
</ul>

    </div>
</div>

          <footer>
            <p class="text-muted">
              &copy; 2018 <a class="text-muted" href="http://mesosphere.com">Mesosphere, Inc.</a>
            </p>
          </footer>
        </div>
      </div>
    </div>
    <script src="//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="//cdn.jsdelivr.net/anchorjs/3.2.2/anchor.min.js"></script>
    <script>
        (function () {
            'use strict';
            anchors.options.placement = 'right';
            anchors.add('h2, h3, h4, h5, h6');
        })();
    </script>
  </body>
</html>