<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Marathon: Marathon Recipes</title>
    <link rel="icon" type="image/x-icon" href="/marathon/img/marathon-favicon.ico">
    <link href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="/marathon/css/style.css" rel="stylesheet">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-45222428-4', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="container-fluid">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/marathon/">Marathon</a>
              </div>
              <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav">
                  <li class="active">
                    <a href="/marathon/docs/">Docs</a>
                  </li>
                  <li >
                    <a href="/marathon/resources.html">Resources</a>
                  </li>
                  <li >
                    <a href="/marathon/support.html">Support</a>
                  </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="https://github.com/mesosphere/marathon">GitHub</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row">
    <div class="col-sm-3">

        <h5>Getting Started</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/">
                    Install Marathon
                </a>
            </li>
            <li>
                <a href="/marathon/docs/setup.html">
                    Setup Recommendations
                </a>
            </li>
            <li>
                <a href="/marathon/docs/high-availability.html">
                    High Availability Mode
                </a>
            </li>
        </ul>

        <h5>Using Marathon</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/application-basics.html">
                    Application Basics
                </a>
            </li>
            <li>
                <a href="/marathon/docs/deployments.html">
                    Application Deployments
                </a>
            </li>
            <li>
                <a href="/marathon/docs/application-groups.html">
                    Application Groups
                </a>
            </li>
            <li>
                <a href="/marathon/docs/artifact-store.html">
                    Artifact Store
                </a>
            </li>
            <li>
                <a href="/marathon/docs/auth-access-ctrl.html">
                    Authorization and Access Control
                </a>
            </li>
            <li>
                <a href="/marathon/docs/blue-green-deploy.html">
                    Blue-Green Deployment
                </a>
            </li>
            <li>
                <a href="/marathon/docs/constraints.html">
                    Constraints
                </a>
            </li>
            <li>
                <a href="/marathon/docs/event-bus.html">
                    Event Bus
                </a>
            </li>
            <li>
                <a href="/marathon/docs/health-checks.html">
                    Health Checks
                </a>
            </li>
            <li>
                <a href="/marathon/docs/ip-per-task.html">
                    IP-per-task
                </a>
            </li>
            <li>
                <a href="/marathon/docs/marathon-ui.html">
                    Marathon Web Interface
                </a>
            </li>
            <li>
                <a href="/marathon/docs/ports.html">
                    Ports
                </a>
            </li>
            <li>
                <a href="/marathon/docs/recipes.html">
                    Recipes
                </a>
            </li>
            <li>
                <a href="/marathon/docs/native-docker.html">
                    Running Docker Containers
                </a>
            </li>
            <li>
                <a href="/marathon/docs/persistent-volumes.html">
                    Stateful Applications Using Local Persistent Volumes
                </a>
            </li>
            <li>
                <a href="/marathon/docs/external-volumes.html">
                    Stateful Applications Using External Persistent Volumes
                </a>
            </li>
            <li>
                <a href="/marathon/docs/task-environment-vars.html">
                    Task Environment Variables
                </a>
            </li>
        </ul>

        <h5>Administration</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/command-line-flags.html">
                    Command Line Flags
                </a>
            </li>
            <li>
                <a href="/marathon/docs/framework-authentication.html">
                    Framework Authentication
                </a>
            </li>
            <li>
                <a href="/marathon/docs/high-availability.html">
                    High Availability
                </a>
            </li>
            <li>
                <a href="/marathon/docs/metrics.html">
                    Metrics
                </a>
            </li>
            <li>
                <a href="/marathon/docs/readiness-checks.html">
                    Readiness Checks
                </a>
            </li>
            <li>
                <a href="/marathon/docs/service-discovery-load-balancing.html">
                    Service Discovery and Load Balancing
                </a>
            </li>
            <li>
                <a href="/marathon/docs/ssl-basic-access-authentication.html">
                    SSL and Basic Authentication
                </a>
            </li>
            <li>
                <a href="/marathon/docs/upgrade/index.html">
                    Upgrading
                </a>
            </li>
            <li>
                <a href="/marathon/docs/upgrade/06xto070.html">
                    Upgrading from 0.6.x
                </a>
            </li>
            <li>
                <a href="/marathon/docs/native-docker-private-registry.html">
                    Using a Private Docker Registry
                </a>
            </li>
            <li>
                <a href="/marathon/docs/upgrade/versioning.html">
                    Versioning
                </a>
            </li>
        </ul>

        <h5>Troubleshooting</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/waiting.html">
                    An App Does Not Leave "Waiting"
                </a>
            </li>
            <li>
                <a href="/marathon/docs/host-port.html">
                    An App Requires a Specific Host Port
                </a>
            </li>
            <li>
                <a href="/marathon/docs/local-cert.html">
                    Error Using HTTPS with local CA Certificate
                </a>
            </li>
            <li>
                <a href="/marathon/docs/auth-secret.html">
                    Error Reading Authentication Secret
                </a>
            </li>
        </ul>

        <h5>Development</h5>
        <ul class="list-unstyled">
            <li>
                <a href="/marathon/docs/contributing.html">
                    Contributor Guidelines
                </a>
            </li>
            <li>
                <a href="/marathon/docs/core-architecture.html">
                    Current Marathon Development
                </a>
            </li>
            <li>
                <a href="/marathon/docs/plugin.html">
                    Extend Marathon with Plugins
                </a>
            </li>
            <li>
                <a href="/marathon/docs/developing-vm.html">
                    Run a Local Version of Marathon
                </a>
            </li>
        </ul>

        <h5>API Reference</h5>
        <ul class="list-unstyled">
        <li>
            <a href="/marathon/docs/generated/api.html">REST API Reference</a>
        </li>

        <li><a href="/marathon/docs/rest-api.html">REST API Reference (deprecated)</a></li>

        </ul>
    </div>

    <div class="col-sm-9">
        <h1 id="marathon-recipes">Marathon Recipes</h1>

<p>Below are some common patterns for specifying Marathon apps.</p>

<h2 id="docker">Docker</h2>

<p>See the detailed docs on
<a href="/marathon/docs/native-docker.html">Docker Containers</a>.</p>

<h3 id="simple-docker-example">Simple Docker Example</h3>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;simple-docker&quot;</span><span class="p">,</span>
    <span class="nt">&quot;container&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;docker&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;busybox&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;cmd&quot;</span><span class="p">:</span> <span class="s2">&quot;echo hello from docker&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cpus&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="nt">&quot;mem&quot;</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
    <span class="nt">&quot;instances&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="docker-with-entry-point">Docker with entry point</h3>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;simple-docker&quot;</span><span class="p">,</span>
    <span class="nt">&quot;container&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;docker&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;mesosphere/inky&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="s2">&quot;from&quot;</span><span class="p">,</span> <span class="s2">&quot;docker&quot;</span><span class="p">],</span>
    <span class="nt">&quot;cpus&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="nt">&quot;mem&quot;</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
    <span class="nt">&quot;instances&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</code></pre></div>
<p>where the &quot;mesosphere/inky&quot; Dockerfile is defined as:</p>
<div class="highlight"><pre><code class="language-Dockerfile" data-lang="Dockerfile"><span class="k">FROM</span> busybox
<span class="k">MAINTAINER</span> support@mesosphere.io

<span class="k">CMD</span> <span class="o">[</span><span class="s2">&quot;inky&quot;</span><span class="o">]</span>
<span class="k">ENTRYPOINT</span> <span class="o">[</span><span class="s2">&quot;echo&quot;</span><span class="o">]</span>
</code></pre></div>
<h3 id="start-a-private-docker-registry">Start a private docker registry</h3>

<p>The following JSON file will make a private Docker registry available in your cluster.</p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;/docker/registry&quot;</span><span class="p">,</span>
  <span class="nt">&quot;instances&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;cpus&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
  <span class="nt">&quot;mem&quot;</span><span class="p">:</span> <span class="mf">1024.0</span><span class="p">,</span>
  <span class="nt">&quot;disk&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
  <span class="nt">&quot;container&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;docker&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;DOCKER&quot;</span><span class="p">,</span>
      <span class="nt">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;registry:latest&quot;</span><span class="p">,</span>
      <span class="nt">&quot;network&quot;</span><span class="p">:</span> <span class="s2">&quot;BRIDGE&quot;</span><span class="p">,</span>
      <span class="nt">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="nt">&quot;portMappings&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;containerPort&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
          <span class="nt">&quot;hostPort&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="nt">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;tcp&quot;</span><span class="p">,</span>
          <span class="nt">&quot;servicePort&quot;</span><span class="p">:</span> <span class="mi">5000</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;volumes&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;hostPath&quot;</span><span class="p">:</span> <span class="s2">&quot;/local/path/to/store/packages&quot;</span><span class="p">,</span>
        <span class="nt">&quot;containerPath&quot;</span><span class="p">:</span> <span class="s2">&quot;/storage&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;RW&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="nt">&quot;env&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;SETTINGS_FLAVOR&quot;</span><span class="p">:</span> <span class="s2">&quot;local&quot;</span><span class="p">,</span>
    <span class="nt">&quot;STORAGE_PATH&quot;</span><span class="p">:</span> <span class="s2">&quot;/storage&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="health-checks">Health Checks</h2>

<p>See the detailed docs on
<a href="/marathon/docs/health-checks.html">Health Checks</a>.</p>

<h3 id="http-health-checks">HTTP health checks</h3>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;toggle&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cmd&quot;</span><span class="p">:</span> <span class="s2">&quot;python toggle.py $PORT0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cpus&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
  <span class="nt">&quot;disk&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="nt">&quot;healthChecks&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;HTTP&quot;</span><span class="p">,</span>
      <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/health&quot;</span><span class="p">,</span>
      <span class="nt">&quot;portIndex&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&quot;gracePeriodSeconds&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="nt">&quot;intervalSeconds&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nt">&quot;timeoutSeconds&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nt">&quot;maxConsecutiveFailures&quot;</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;instances&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="nt">&quot;mem&quot;</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
  <span class="nt">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
  <span class="nt">&quot;uris&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;http://downloads.mesosphere.com/misc/toggle.tgz&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="tcp-health-checks">TCP health checks</h3>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;toggle&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cmd&quot;</span><span class="p">:</span> <span class="s2">&quot;python toggle.py $PORT0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cpus&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
  <span class="nt">&quot;disk&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="nt">&quot;healthChecks&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;TCP&quot;</span><span class="p">,</span>
      <span class="nt">&quot;portIndex&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&quot;gracePeriodSeconds&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="nt">&quot;intervalSeconds&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nt">&quot;timeoutSeconds&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nt">&quot;maxConsecutiveFailures&quot;</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;instances&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="nt">&quot;mem&quot;</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
  <span class="nt">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
  <span class="nt">&quot;uris&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;http://downloads.mesosphere.com/misc/toggle.tgz&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="command-executor-health-checks">Command (executor) health checks</h3>

<p>Command health checks are executed on the slave where the task is running.
To enable this feature for marathon versions prior to <code>0.7.4</code>, start Marathon with the <code>--executor_health_checks</code> flag (not required/allowed since <code>0.7.4</code>). Requires Mesos version <code>0.20.0</code> or later.</p>
<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;toggle&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cmd&quot;</span><span class="p">:</span> <span class="s2">&quot;python toggle.py $PORT0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cpus&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
  <span class="nt">&quot;disk&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="nt">&quot;healthChecks&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;protocol&quot;</span><span class="p">:</span> <span class="s2">&quot;COMMAND&quot;</span><span class="p">,</span>
      <span class="nt">&quot;command&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;curl -f http://$HOST:$PORT0/&quot;</span> <span class="p">},</span>
      <span class="nt">&quot;gracePeriodSeconds&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="nt">&quot;intervalSeconds&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nt">&quot;timeoutSeconds&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="nt">&quot;maxConsecutiveFailures&quot;</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;instances&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="nt">&quot;mem&quot;</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">,</span>
  <span class="nt">&quot;ports&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
  <span class="nt">&quot;uris&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;http://downloads.mesosphere.com/misc/toggle.tgz&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="constraining-task-placement-static-partitioning">Constraining task placement / static partitioning</h2>

<p>Usually, Marathon decides where to start your application tasks without your input. This allows your infrastructure to scale easily, since all resources are treated equally.</p>

<p>However, there are times when you want to separate some machines from the common pool and schedule only certain tasks on them. For example:</p>

<ul>
<li><p>Some nodes in your cluster have publicly reachable network addresses and you only want to start tasks there that make use of public addresses.</p></li>
<li><p>Some nodes in your cluster have special hardware, such as very fast SSDs or GPUs, that you want to reserve for tasks that need this hardware.</p></li>
</ul>

<p>See the detailed docs on
<a href="/marathon/docs/constraints.html">constraints</a>.</p>

<h3 id="using-roles">Using roles</h3>

<p>You can configure some of your Mesos agents to only offer their resources to a specific Mesos role. Only Mesos frameworks (such as Marathon) that are configured for this specific Mesos role will get offers for these resources. In this way, you can prevent accidental usage of these resources by other Mesos frameworks.</p>

<ol>
<li><p>Configure Marathon: <code>--mesos_role yourrole</code></p></li>
<li><p>Configure the Mesos master: <code>--roles=&lt;...other roles...&gt;,yourrole</code></p></li>
<li><p>Configuring the Mesos agents whose resource offers you want to restrict. Either use the  <code>--default_role yourrole</code> flag to assign all that agent&#39;s resources to your role or use the <code>--resources</code> flag to assign individual resources to that role (such as a certain port range). See <a href="http://mesos.apache.org/documentation/latest/configuration/">the Mesos command line documentation</a> for details.</p></li>
</ol>

<h3 id="preventing-accidental-use-of-special-roles-inside-marathon">Preventing Accidental Use of Special Roles inside Marathon</h3>

<p>With the base setup, that is, with no command-line parameters specified, all Marathon applications will by default use all resources either assigned to the unspecific &quot;*&quot; role or the role you specified with <code>--mesos_role</code>.</p>

<p>To ensure that only special tasks are run on nodes you specify, you can use a separate Marathon instance for those tasks.</p>

<p>You can also configure Marathon to ignore your special roles for apps by default, then explicitly configure the exceptions:</p>

<ol>
<li><p>Configure Marathon to ignore the special resources by default: <code>--default_accepted_resource_roles &#39;*&#39;</code> (make sure
that you quote the &quot;*&quot; correctly)</p></li>
<li><p>Configure an app to run on top of resources of your special role:</p></li>
</ol>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;/my.special.app&quot;</span><span class="p">,</span>
    <span class="s2">&quot;acceptedResourceRoles&quot;</span><span class="o">:</span> <span class="p">[</span> <span class="s2">&quot;yourrole&quot;</span> <span class="p">]</span>
    <span class="c1">// ... more config ...</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="limitations-of-static-partitioning-with-roles">Limitations of Static Partitioning with Roles</h3>

<ul>
<li><p>One framework can currently only be assigned to one role. So if you have multiple types of special nodes, you need to have separate frameworks for them.</p></li>
<li><p>You must reconfigure your Mesos master and some of your agents in order to use this functionality.</p></li>
</ul>

<h3 id="using-constraints">Using constraints</h3>

<p>You can use constraints to restrict where to run the tasks for your apps. See
<a href="%7B%20site.baseurl%20%7D%7D/docs/constraints.html">constraints</a> for details.</p>

<p>The advantage of using constraints to restrict where tasks run is that you only have to provide appropriate attributes on the Mesos agents.</p>

<p>The disadvantages are that nothing prevents another framework from scheduling tasks on these agents and consuming all the resources your special tasks need. To avoid this, you need to configure Marathon so that all non-special apps are constrained <em>not</em> to use the special nodes.</p>

<h2 id="running-a-single-instance-application">Running a Single Instance Application</h2>

<p>Often, multiple instances of legacy applications cannot be run concurrently. The <code>MARATHON_SINGLE_INSTANCE_APP</code> label allows you to prevent users from scaling such an application beyond a single instance.</p>

<ol>
<li>In your application definition, set the label <code>MARATHON_SINGLE_INSTANCE_APP</code> to true:</li>
</ol>
<div class="highlight"><pre><code class="language-json" data-lang="json">  <span class="s2">&quot;labels&quot;</span><span class="err">:</span><span class="p">{</span>
    <span class="nt">&quot;MARATHON_SINGLE_INSTANCE_APP&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
  <span class="p">}</span>
</code></pre></div>
<ol>
<li>Specify the following <code>upgradeStrategy</code>, which permits Marathon to kill all instances:</li>
</ol>
<div class="highlight"><pre><code class="language-json" data-lang="json">  <span class="s2">&quot;upgradeStrategy&quot;</span><span class="err">:</span><span class="p">{</span>
    <span class="nt">&quot;minimumHealthCapacity&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">&quot;maximumOverCapacity&quot;</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">}</span>
</code></pre></div>
    </div>
</div>

          <footer>
            <p class="text-muted">
              &copy; 2016 <a class="text-muted" href="http://mesosphere.com">Mesosphere, Inc.</a>
            </p>
          </footer>
        </div>
      </div>
    </div>
    <script src="//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>
