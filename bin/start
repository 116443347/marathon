#!/bin/bash
set -o errexit -o nounset -o pipefail

MASTER='zk://localhost:2181/mesos'
while getopts m: opt; do
  case $opt in
    m)
      MASTER="$OPTARG"
      ;;
  esac
done

FRAMEWORK_HOME=`dirname $0`/..

if [ -z ${MESOS_HOME+x} ]
then
  echo "MESOS_HOME is not set. Defaulting to /usr/local"
  MESOS_HOME='/usr/local'
else
  echo "MESOS_HOME is set to: $MESOS_HOME"
fi

export MESOS_NATIVE_LIBRARY=$(find "$MESOS_HOME" -name libmesos.dylib -or -name libmesos.so | head -n1)
echo "MESOS_NATIVE_LIBRARY set to $MESOS_NATIVE_LIBRARY"

# Start Marathon
java -cp "$FRAMEWORK_HOME"/target/marathon-*.jar mesosphere.marathon.Main --master "$MASTER" "$@"
